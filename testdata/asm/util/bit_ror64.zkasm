;; Rotate right a u64 word

include "bit_xoan.zkasm"
include "bit_shr64.zkasm"
include "bit_shl64.zkasm"

fn bit_ror64(word u64, n u6) -> (res u64) {
      if n == 0  goto unchanged
      var shr_word u64
      var shl_word u64
      ;; prepare index for shift left
      var index u6
      var c0 u1
      c0, index = 64 - n
      ;; shift word right and left with correct n value
      shl_word = bit_shl64(word, index)
      shr_word = bit_shr64(word, n)
      ;; apply OR to the shifted left and right limbs
      res = bit_xoan_u64(1, shl_word, shr_word)
      return
unchanged:
      res = word
      return
}