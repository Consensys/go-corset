;; Rotate right a u64 word

include "bit_xoan.zkasm"
include "bit_shr64.zkasm"
include "bit_shl64.zkasm"

fn bit_ror64(word u64, n u6) -> (res u64) {
      if n == 0  goto unchanged
      var copy_rest u64
      var shifted_word u64
      var index u6
      var c0 u1
      c0, index = 64 - n
      shifted_word = bit_shl64(word, index)
      copy_rest = bit_shr64(word, n)
      ;; apply or to the shifted and copied limbs
      res = bit_xoan_u64(1, shifted_word, copy_rest)
      return
unchanged:
      res = word
      return
}