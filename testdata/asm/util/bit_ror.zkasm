;; Rotate right a u256 word

include "bit_xoan.zkasm"

fn bit_ror64(word u64, n u8) -> (res u64) {
      if n == 0  goto unchanged
      var copy_rest u64
      var shifted_word u64
      ;; isolate bit and shift
      if n == 63 goto split_63_1
      if n == 62 goto split_62_2
      if n == 61 goto split_61_3
      if n == 60 goto split_60_4
      if n == 59 goto split_59_5
      if n == 58 goto split_58_6
      if n == 57 goto split_57_7
      if n == 56 goto split_56_8
      if n == 55 goto split_55_9
      if n == 54 goto split_54_10
      if n == 53 goto split_53_11
      if n == 52 goto split_52_12
      if n == 52 goto split_52_12
      if n == 52 goto split_52_12
      if n == 52 goto split_52_12
      if n == 52 goto split_52_12
unchanged:
      res = word
      return
split_63_1:
      var lhs63 u63
      var rhs1  u1
      rhs1, lhs63 = word
      shifted_word = lhs63 * 2
      copy_rest = rhs1
      goto exit
split_62_2:
      var lhs62 u62
      var rhs2 u2
      rhs2, lhs62 = word
      shifted_word = lhs62 * 2^2
      copy_rest = rhs2
      goto exit
split_61_3:
      var lhs61 u61
      var rhs3 u3
      rhs3, lhs61 = word
      shifted_word = lhs61 * 2^3
      copy_rest = rhs3
      goto exit
split_60_4:
      var lhs60 u60
      var rhs4 u4
      rhs4, lhs60 = word
      shifted_word = lhs60 * 2^4
      copy_rest = rhs4
      goto exit
split_59_5:
      var lhs59 u59
      var rhs5 u5
      rhs5, lhs59 = word
      shifted_word = lhs59 * 2^5
      copy_rest = rhs5
      goto exit
split_58_6:
      var lhs58 u58
      var rhs6 u6
      rhs6, lhs58 = word
      shifted_word = lhs58 * 2^6
      copy_rest = rhs6
      goto exit
split_57_7:
      var lhs57 u57
      var rhs7 u7
      rhs7, lhs57 = word
      shifted_word = lhs57 * 2^7
      copy_rest = rhs7
      goto exit
split_56_8:
      var lhs56 u56
      var rhs8 u8
      rhs8, lhs56 = word
      shifted_word = lhs56 * 2^8
      copy_rest = rhs8
      goto exit
split_55_9:
      var lhs55 u55
      var rhs9 u9
      rhs9, lhs55 = word
      shifted_word = lhs55 * 2^9
      copy_rest = rhs9
      goto exit
split_54_10:
      var lhs54 u54
      var rhs10 u10
      rhs10, lhs54 = word
      shifted_word = lhs54 * 2^10
      copy_rest = rhs10
      goto exit
split_53_11:
      var lhs53 u53
      var rhs11 u11
      rhs11, lhs53 = word
      shifted_word = lhs53 * 2^11
      copy_rest = rhs11
      goto exit
exit:
      ;; apply or to the shifted and copied limbs
      res = bit_xoan_u64(1, shifted_word, copy_rest)
      return
}